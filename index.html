<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Enhanced Inventory Management System</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Arial', sans-serif;
    }
    body {
      background-color: #f4f7f6;
      color: #333;
      padding: 20px;
      transition: background-color 0.3s, color 0.3s;
    }
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
      padding: 20px;
      border-radius: 8px;
      transition: background-color 0.3s, color 0.3s;
    }
    header {
      text-align: center;
      margin-bottom: 30px;
      position: relative;
    }
    header h1 {
      font-size: 36px;
      color: #5A5A5A;
    }
    .theme-toggle {
      position: absolute;
      top: 0;
      right: 0;
      background-color: #5A5A5A;
      color: white;
      border: none;
      border-radius: 50%;
      width: 30px;
      height: 30px;
      display: flex;
      justify-content: center;
      align-items: center;
      cursor: pointer;
      font-size: 14px;
      padding: 0;
    }
    .theme-toggle:hover {
      background-color: #444;
    }
    .theme-toggle-icon {
      font-size: 14px;
    }
    .main-content {
      display: flex;
      flex-wrap: wrap;
      gap: 20px;
    }
    .left-panel {
      flex: 1;
      min-width: 300px;
    }
    .right-panel {
      flex: 1;
      min-width: 300px;
      display: none;
    }
    .inventory-form {
      margin-bottom: 40px;
      padding: 20px;
      background-color: #f9f9f9;
      border-radius: 8px;
      transition: background-color 0.3s;
    }
    .inventory-form h2 {
      font-size: 24px;
      color: #4CAF50;
      margin-bottom: 15px;
    }
    label {
      display: block;
      font-size: 14px;
      color: #777;
      margin-bottom: 5px;
      transition: color 0.3s;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 20px;
      font-size: 16px;
      border: 1px solid #ddd;
      border-radius: 4px;
      background-color: white;
      color: #333;
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }
    textarea {
      min-height: 100px;
      resize: vertical;
    }
    button {
      width: 100%;
      padding: 12px;
      font-size: 16px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    button:hover {
      background-color: #45a049;
    }
    .inventory-list {
      overflow-x: auto;
    }
    .inventory-list table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    .inventory-list th, .inventory-list td {
      padding: 12px;
      text-align: center;
      border-bottom: 1px solid #ddd;
      transition: background-color 0.3s, color 0.3s, border-color 0.3s;
    }
    .inventory-list th {
      background-color: #4CAF50;
      color: white;
    }
    .inventory-list td {
      background-color: #f9f9f9;
      transition: background-color 0.3s;
    }
    .actions button {
      padding: 6px 12px;
      margin: 2px;
      background-color: #f44336;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: auto;
    }
    .view-button {
      background-color: #2196F3;
    }
    .view-button:hover {
      background-color: #0b7dda;
    }
    .exit-button {
      margin-top: 20px;
      background-color: #f44336;
      color: white;
      padding: 10px;
      width: 100%;
      font-size: 16px;
      border-radius: 4px;
      cursor: pointer;
    }
    .exit-button:hover {
      background-color: #e53935;
    }
    .toggle-form-button {
      background-color: #673AB7;
      margin-bottom: 20px;
    }
    .toggle-form-button:hover {
      background-color: #5e35b1;
    }
    footer {
      text-align: center;
      margin-top: 40px;
      font-size: 14px;
      color: #777;
      transition: color 0.3s;
    }
    .search-container {
      display: flex;
      justify-content: space-between;
      margin-bottom: 20px;
    }
    .search-container input {
      width: 80%;
      margin-right: 10px;
    }
    .search-container button {
      width: 18%;
    }
    .item-detail {
      padding: 20px;
      background-color: #f9f9f9;
      border-radius: 8px;
      margin-bottom: 20px;
      transition: background-color 0.3s;
    }
    .item-detail h2 {
      font-size: 24px;
      color: #2196F3;
      margin-bottom: 15px;
    }
    .item-image {
      width: 100%;
      height: 200px;
      background-color: #ddd;
      display: flex;
      justify-content: center;
      align-items: center;
      margin-bottom: 20px;
      border-radius: 4px;
      overflow: hidden;
    }
    .item-image img {
      max-width: 100%;
      max-height: 100%;
      object-fit: contain;
    }
    .quantity-control {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
    }
    .quantity-control button {
      width: 40px;
      height: 40px;
      font-size: 20px;
      padding: 0;
      border-radius: 50%;
    }
    .quantity-control input {
      width: 60px;
      text-align: center;
      margin: 0 10px;
    }
    .edit-detail-button {
      background-color: #FF9800;
      margin-bottom: 10px;
    }
    .edit-detail-button:hover {
      background-color: #F57C00;
    }
    .save-detail-button {
      background-color: #4CAF50;
      margin-bottom: 10px;
    }
    .save-detail-button:hover {
      background-color: #45a049;
    }
    .back-button {
      background-color: #607D8B;
      margin-bottom: 10px;
    }
    .back-button:hover {
      background-color: #546E7A;
    }
    .detail-info {
      margin-bottom: 20px;
    }
    .detail-info p {
      margin-bottom: 10px;
      font-size: 16px;
    }
    .detail-label {
      font-weight: bold;
      color: #555;
      transition: color 0.3s;
    }
    .detail-value {
      margin-left: 10px;
      transition: color 0.3s;
    }
    .detail-view .edit-mode {
      display: none;
    }
    .detail-edit .read-mode {
      display: none;
    }
    .detail-view .read-mode, .detail-edit .edit-mode {
      display: block;
    }
    .clickable {
      cursor: pointer;
      text-decoration: underline;
      color: #2196F3;
    }
    .clickable:hover {
      color: #0b7dda;
    }
    /* Dark mode styles */
    body.dark-mode {
      background-color: #121212;
      color: #f0f0f0;
    }
    .dark-mode .container {
      background: #1e1e1e;
      box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
    }
    .dark-mode header h1 {
      color: #f0f0f0;
    }
    .dark-mode .theme-toggle {
      background-color: #333;
    }
    .dark-mode .inventory-form {
      background-color: #2d2d2d;
    }
    .dark-mode label {
      color: #bbb;
    }
    .dark-mode input, .dark-mode textarea {
      background-color: #333;
      color: #f0f0f0;
      border-color: #555;
    }
    .dark-mode .inventory-list td {
      background-color: #2d2d2d;
      border-bottom-color: #444;
    }
    .dark-mode .detail-label {
      color: #bbb;
    }
    .dark-mode .item-detail {
      background-color: #2d2d2d;
    }
    .dark-mode footer {
      color: #bbb;
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Inventory Management System</h1>
      <button class="theme-toggle" onclick="toggleTheme()">
        <span class="theme-toggle-icon">â˜€</span>
      </button>
    </header>
    <!-- Search Bar Section -->
    <div class="search-container">
      <input type="text" id="search-bar" placeholder="Search for an item...">
      <button onclick="searchItem()">Search</button>
    </div>
    <button class="toggle-form-button" onclick="toggleFormPanel()">Add New Item</button>
    <div class="main-content">
      <!-- Left Panel - Inventory List -->
      <div class="left-panel">
        <section class="inventory-list">
          <h2>Inventory List</h2>
          <table id="inventoryTable">
            <thead>
              <tr>
                <th>Item</th>
                <th>Quantity</th>
                <th>Price</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <!-- Inventory items will be dynamically inserted here -->
            </tbody>
          </table>
        </section>
      </div>
      <!-- Right Panel - Add/Edit Form -->
      <div class="right-panel" id="formPanel">
        <section class="inventory-form">
          <h2>Add New Item</h2>
          <form id="inventoryForm">
            <label for="item-name">Item Name</label>
            <input type="text" id="item-name" placeholder="Enter item name" required>
            <label for="item-quantity">Quantity</label>
            <input type="number" id="item-quantity" placeholder="Enter quantity" required>
            <label for="item-price">Price</label>
            <input type="number" id="item-price" placeholder="Enter price" required>
            <label for="item-description">Description</label>
            <textarea id="item-description" placeholder="Enter item description"></textarea>
            <label for="item-image">Image URL</label>
            <input type="text" id="item-image" placeholder="Enter image URL">
            <button type="submit">Add Item</button>
          </form>
        </section>
      </div>
      <!-- Item Detail View (Initially Hidden) -->
      <div class="right-panel detail-view" id="detailPanel">
        <div class="item-detail">
          <h2 id="detail-title">Item Details</h2>
          <div class="item-image">
            <img id="detail-image" src="" alt="Item Image">
          </div>
          <!-- Read Mode -->
          <div class="read-mode">
            <div class="detail-info">
              <p><span class="detail-label">Description:</span> <span id="detail-description" class="detail-value"></span></p>
              <p><span class="detail-label">Price:</span> <span id="detail-price" class="detail-value"></span></p>
              <div class="quantity-control">
                <span class="detail-label">Quantity:</span>
                <button onclick="decreaseQuantity()">-</button>
                <input type="number" id="detail-quantity" readonly>
                <button onclick="increaseQuantity()">+</button>
              </div>
              <p><span class="detail-label">Total Value:</span> <span id="detail-total" class="detail-value"></span></p>
            </div>
            <button class="edit-detail-button" onclick="switchToEditMode()">Edit Details</button>
            <button class="back-button" onclick="hideDetailPanel()">Back to Inventory</button>
          </div>
          <!-- Edit Mode -->
          <div class="edit-mode">
            <form id="editForm">
              <label for="edit-name">Item Name</label>
              <input type="text" id="edit-name" required>
              <label for="edit-description">Description</label>
              <textarea id="edit-description"></textarea>
              <label for="edit-price">Price</label>
              <input type="number" id="edit-price" required>
              <label for="edit-quantity">Quantity</label>
              <input type="number" id="edit-quantity" required>
              <label for="edit-image">Image URL</label>
              <input type="text" id="edit-image">
              <button type="submit" class="save-detail-button">Save Changes</button>
              <button type="button" class="back-button" onclick="cancelEdit()">Cancel</button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Exit Button -->
    <button class="exit-button" onclick="exitInventory()">reset</button>
    <footer>
      <p>Enhanced Inventory Management System</p>
    </footer>
  </div>
  <script>
    // Global variables
    let currentItemIndex = -1;
    let isDarkMode = false;
    
    // Load inventory data and theme preference from localStorage on page load
    window.onload = function() {
      const storedItems = JSON.parse(localStorage.getItem('inventory')) || [];
      storedItems.forEach((item, index) => {
        addItemToInventory(item, index);
      });
      
      // Load theme preference
      const savedTheme = localStorage.getItem('theme');
      if (savedTheme === 'dark') {
        enableDarkMode();
      }
    };
    
    // Toggle between light and dark mode
    function toggleTheme() {
      if (isDarkMode) {
        disableDarkMode();
      } else {
        enableDarkMode();
      }
    }
    
    // Enable dark mode
    function enableDarkMode() {
      document.body.classList.add('dark-mode');
      document.querySelector('.theme-toggle-icon').textContent = 'ðŸŒ™';
      isDarkMode = true;
      localStorage.setItem('theme', 'dark');
    }
    
    // Disable dark mode
    function disableDarkMode() {
      document.body.classList.remove('dark-mode');
      document.querySelector('.theme-toggle-icon').textContent = 'â˜€';
      isDarkMode = false;
      localStorage.setItem('theme', 'light');
    }
    
    // Handle form submission for new items
    document.getElementById('inventoryForm').addEventListener('submit', function(event) {
      event.preventDefault();
      const itemName = document.getElementById('item-name').value;
      const itemQuantity = document.getElementById('item-quantity').value;
      const itemPrice = document.getElementById('item-price').value;
      const itemDescription = document.getElementById('item-description').value;
      const itemImage = document.getElementById('item-image').value;
      if (itemName && itemQuantity && itemPrice) {
        const newItem = {
          name: itemName,
          quantity: parseInt(itemQuantity),
          price: parseFloat(itemPrice),
          description: itemDescription || 'No description available',
          image: itemImage || 'placeholder.jpg'
        };
        // Save to localStorage and update display
        saveItem(newItem);
        clearForm();
        toggleFormPanel();
      } else {
        alert('Please fill out all required fields');
      }
    });
    // Handle form submission for editing items
    document.getElementById('editForm').addEventListener('submit', function(event) {
      event.preventDefault();
      if (currentItemIndex >= 0) {
        const updatedItem = {
          name: document.getElementById('edit-name').value,
          description: document.getElementById('edit-description').value,
          price: parseFloat(document.getElementById('edit-price').value),
          quantity: parseInt(document.getElementById('edit-quantity').value),
          image: document.getElementById('edit-image').value
        };
        updateItem(currentItemIndex, updatedItem);
        switchToReadMode();
        refreshDetailView(updatedItem);
      }
    });
    // Function to add item to inventory list
    function addItemToInventory(item, index) {
      const tableBody = document.querySelector('#inventoryTable tbody');
      const row = document.createElement('tr');
      row.innerHTML = `
        <td class="clickable" onclick="viewItemDetails(${index})">${item.name}</td>
        <td>${item.quantity}</td>
        <td>â‚¹${parseFloat(item.price).toFixed(2)}</td>
        <td class="actions">
          <button class="view-button" onclick="viewItemDetails(${index})">View</button>
          <button onclick="removeItem(this, ${index})">Remove</button>
        </td>
      `;
      tableBody.appendChild(row);
    }
    // Function to view item details
    function viewItemDetails(index) {
      const storedItems = JSON.parse(localStorage.getItem('inventory')) || [];
      if (index >= 0 && index < storedItems.length) {
        const item = storedItems[index];
        currentItemIndex = index;
        // Switch to detail panel
        document.getElementById('formPanel').style.display = 'none';
        document.getElementById('detailPanel').style.display = 'block';
        // Make sure we're in read mode
        document.getElementById('detailPanel').classList.remove('detail-edit');
        document.getElementById('detailPanel').classList.add('detail-view');
        // Update detail view with item data
        refreshDetailView(item);
      }
    }
    // Refresh the detail view with current item data
    function refreshDetailView(item) {
      document.getElementById('detail-title').textContent = item.name;
      document.getElementById('detail-description').textContent = item.description;
      document.getElementById('detail-price').textContent = `â‚¹${parseFloat(item.price).toFixed(2)}`;
      document.getElementById('detail-quantity').value = item.quantity;
      document.getElementById('detail-total').textContent = `â‚¹${(item.price * item.quantity).toFixed(2)}`;
      // Set image src with fallback
      const imgElement = document.getElementById('detail-image');
      imgElement.src = item.image;
      imgElement.onerror = function() {
        this.src = 'https://via.placeholder.com/200x150?text=No+Image';
      };
      // Set edit form values as well
      document.getElementById('edit-name').value = item.name;
      document.getElementById('edit-description').value = item.description;
      document.getElementById('edit-price').value = item.price;
      document.getElementById('edit-quantity').value = item.quantity;
      document.getElementById('edit-image').value = item.image;
    }
    // Switch to edit mode for details
    function switchToEditMode() {
      document.getElementById('detailPanel').classList.remove('detail-view');
      document.getElementById('detailPanel').classList.add('detail-edit');
    }
    // Switch back to read mode for details
    function switchToReadMode() {
      document.getElementById('detailPanel').classList.remove('detail-edit');
      document.getElementById('detailPanel').classList.add('detail-view');
    }
    // Cancel edit operation
    function cancelEdit() {
      // Simply switch back to read mode, without saving changes
      switchToReadMode();
      // Refresh the view with original data
      const storedItems = JSON.parse(localStorage.getItem('inventory')) || [];
      if (currentItemIndex >= 0 && currentItemIndex < storedItems.length) {
        refreshDetailView(storedItems[currentItemIndex]);
      }
    }
    // Hide the detail panel
    function hideDetailPanel() {
      document.getElementById('detailPanel').style.display = 'none';
      currentItemIndex = -1;
    }
    // Increase quantity from detail view
    function increaseQuantity() {
      if (currentItemIndex >= 0) {
        const storedItems = JSON.parse(localStorage.getItem('inventory')) || [];
        if (currentItemIndex < storedItems.length) {
          storedItems[currentItemIndex].quantity++;
          localStorage.setItem('inventory', JSON.stringify(storedItems));
          // Update display
          refreshDetailView(storedItems[currentItemIndex]);
          refreshInventoryTable();
        }
      }
    }
    // Decrease quantity from detail view
    function decreaseQuantity() {
      if (currentItemIndex >= 0) {
        const storedItems = JSON.parse(localStorage.getItem('inventory')) || [];
        if (currentItemIndex < storedItems.length && storedItems[currentItemIndex].quantity > 0) {
          storedItems[currentItemIndex].quantity--;
          localStorage.setItem('inventory', JSON.stringify(storedItems));
          // Update display
          refreshDetailView(storedItems[currentItemIndex]);
          refreshInventoryTable();
        }
      }
    }
    // Save a new item
    function saveItem(item) {
      const storedItems = JSON.parse(localStorage.getItem('inventory')) || [];
      storedItems.push(item);
      localStorage.setItem('inventory', JSON.stringify(storedItems));
      // Add to table display
      addItemToInventory(item, storedItems.length - 1);
    }
    // Update an existing item
    function updateItem(index, updatedItem) {
      const storedItems = JSON.parse(localStorage.getItem('inventory')) || [];
      if (index >= 0 && index < storedItems.length) {
        storedItems[index] = updatedItem;
        localStorage.setItem('inventory', JSON.stringify(storedItems));
        // Refresh table display
        refreshInventoryTable();
      }
    }
    // Remove item from inventory list and update localStorage
    function removeItem(button, index) {
      const row = button.closest('tr');
      row.remove();
      // Remove item from localStorage
      const storedItems = JSON.parse(localStorage.getItem('inventory')) || [];
      storedItems.splice(index, 1);
      localStorage.setItem('inventory', JSON.stringify(storedItems));
      // Hide detail panel if it was showing the removed item
      if (currentItemIndex === index) {
        hideDetailPanel();
      }
      // Refresh the table to update indices
      refreshInventoryTable();
    }
    // Refresh the entire inventory table
    function refreshInventoryTable() {
      const tableBody = document.querySelector('#inventoryTable tbody');
      tableBody.innerHTML = '';
      const storedItems = JSON.parse(localStorage.getItem('inventory')) || [];
      storedItems.forEach((item, index) => {
        addItemToInventory(item, index);
      });
    }
    // Toggle the form panel
    function toggleFormPanel() {
      const formPanel = document.getElementById('formPanel');
      const detailPanel = document.getElementById('detailPanel');
      if (formPanel.style.display === 'none' || formPanel.style.display === '') {
        formPanel.style.display = 'block';
        detailPanel.style.display = 'none';
      } else {
        formPanel.style.display = 'none';
      }
    }
    // Clear form inputs after adding item
    function clearForm() {
      document.getElementById('item-name').value = '';
      document.getElementById('item-quantity').value = '';
      document.getElementById('item-price').value = '';
      document.getElementById('item-description').value = '';
      document.getElementById('item-image').value = '';
    }
    // Exit button functionality to clear all inventory and localStorage
    function exitInventory() {
      if (confirm('Are you sure you want to exit? This will clear all inventory data.')) {
        // Clear the table
        const tableBody = document.querySelector('#inventoryTable tbody');
        tableBody.innerHTML = '';
        // Clear inventory localStorage but keep theme preference
        localStorage.removeItem('inventory');
        // Alert the user
        alert('Inventory has been cleared and saved data has been removed.');
        // Try to close the window (may not work in all browsers)
        window.close();
      }
    }
    // Search item functionality
    function searchItem() {
      const searchTerm = document.getElementById('search-bar').value.toLowerCase();
      const rows = document.querySelectorAll('#inventoryTable tbody tr');
      rows.forEach(row => {
        const itemName = row.cells[0].textContent.toLowerCase();
        if (itemName.includes(searchTerm)) {
          row.style.display = ''; // Show matching item
        } else {
          row.style.display = 'none'; // Hide non-matching item
        }
      });
    }
  </script>
</body>
</html>
